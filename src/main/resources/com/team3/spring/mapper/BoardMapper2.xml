<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.team3.spring.mapper.BoardMapper2">
	<select id="list" resultType="com.team3.spring.vo.BoardVO2">
	    SELECT P_ID, P_TITLE, P_STATUS, DATE_FORMAT(P_CREATED, '%Y-%m-%d') as P_CREATED, P_HITCOUNT 
	    FROM BOARD_INQUIRY LIMIT #{page}, ${@com.team3.spring.vo.BoardConfig@AMOUNT_PER_PAGE}
	</select>
	
	<select id="listSearch" parameterType="map" resultType="com.team3.spring.vo.BoardVO2">
	    SELECT P_ID, P_TITLE, P_STATUS, DATE_FORMAT(P_CREATED, '%Y-%m-%d') as P_CREATED, P_HITCOUNT 
	    FROM BOARD_INQUIRY 
	    WHERE ${searchKey} LIKE CONCAT('%', #{word}, '%') 
	    LIMIT #{page}, ${@com.team3.spring.vo.BoardConfig@AMOUNT_PER_PAGE}
	</select>
	
	<insert id="write">
		INSERT INTO BOARD_INQUIRY(P_WRITER, P_TITLE, P_TEXT) values (#{p_writer}, #{p_title}, #{p_text})
	</insert>
	
	<select id="read" resultType="com.team3.spring.vo.BoardVO2">
		SELECT * FROM BOARD_INQUIRY WHERE P_ID = #{p_id}
	</select>
	
	<update id="modify">
		UPDATE BOARD_INQUIRY SET P_TITLE = #{p_title}, P_TEXT = #{p_text} WHERE P_ID = #{p_id}
	</update>
	
	<select id="getTotalCount" resultType="int">
		SELECT COUNT(*) FROM BOARD_INQUIRY
	</select>
	
	<select id="getSearchTotalCount" resultType="int">
		SELECT COUNT(*) FROM BOARD_INQUIRY 
		WHERE ${searchKey} LIKE CONCAT('%', #{word}, '%')
	</select>
	
	<update id="updateHitCount" parameterType="long">
		UPDATE BOARD_INQUIRY SET P_HITCOUNT=P_HITCOUNT+1 WHERE P_ID = #{p_id}
	</update>
	
	<select id="getNextArticleId" parameterType="Long" resultType="Long">
        SELECT MIN(p_id) FROM BOARD_INQUIRY WHERE p_id &gt; #{currentArticleId}
    </select>
    
    <select id="getPreviousArticleId" parameterType="Long" resultType="Long">
    	SELECT MAX(p_id) FROM BOARD_INQUIRY WHERE p_id &lt; #{currentArticleId}
	</select>
</mapper>